# Experience Card Detail Feature

## 功能概述

✅ **已完成** - 经验卡片详情页面功能已全面实现，包括：
- 完整的详情页面编辑功能
- 实时进度跟踪系统
- 胶囊形进度条显示
- 卡片删除管理功能
- 英文字段标签
- 颜色编码的完整度指示

当用户点击经验卡片时会弹出详情页面供用户填写完整的经验信息，系统会根据信息完整度实时显示不同颜色的进度条。

## 已实现功能特点

### 1. 详情页面结构 ✅
- **统一的内容框架**：整体结构不可删除，但每个区域内容可点击进入修改
- **七个核心字段**（英文标签）：
  - ✅ Experience Name: 经验名称
  - ✅ Location & Time: 地点 + 时间（事件背景）
  - ✅ Scenario Introduction: 情境设定
  - ✅ My Role: 我的角色
  - ✅ Event Summary: 事件过程与任务描述
  - ✅ Personal Reflection & Outcome Summary: 反思总结与成就收获
  - ✅ One-line Highlight: 一句话高亮总结

### 2. 进度跟踪系统 ✅
- ✅ **实时进度计算**：根据填写字段数量自动计算完整度百分比
- ✅ **颜色编码进度条**：
  - 🔴 红色（0-30%）：填写内容较少，信息严重不完整
  - 🟡 黄色（30-70%）：填写基本完成，但仍有可补充部分
  - 🟢 绿色（70%以上）：填写完整，可直接用于分析与匹配
- ✅ **胶囊形进度条**：卡片左上角显示胶囊形进度条，实时反映完整度
- ✅ **详情页进度条**：详情页面顶部显示当前完整度和进度条
- ✅ **平滑动画**：进度变化有平滑过渡效果

### 3. 交互设计 ✅
- ✅ **点击编辑**：点击任意字段区域进入编辑模式
- ✅ **自动聚焦**：编辑时自动聚焦到输入框
- ✅ **失焦保存**：点击其他区域或按Tab键自动保存当前编辑
- ✅ **视觉反馈**：编辑状态下有蓝色边框高亮
- ✅ **响应式设计**：支持桌面和移动端

### 4. 卡片管理 ✅
- ✅ **删除功能**：每个用户创建的卡片右上角有删除按钮
- ✅ **删除确认**：点击删除按钮立即删除卡片（从界面和数据中移除）
- ✅ **状态同步**：删除操作同时更新界面和数据状态
- ✅ **创建新卡片**：支持通过"Create New Card"按钮创建新卡片

### 5. 页面导航 ✅
- ✅ **Confirm按钮**：保存所有内容并关闭详情页面
- ✅ **关闭按钮**：右上角×按钮可关闭页面（不保存未确认的更改）
- ✅ **模态框设计**：详情页面以模态框形式展示，背景遮罩

## 技术实现 ✅

### 组件文件
- ✅ `src/components/ExperienceCardDetail.tsx` - 详情页面主组件
- ✅ `src/components/ExperienceCard.tsx` - 经验卡片组件（含胶囊进度条）
- ✅ `src/components/CardCategory.tsx` - 卡片分类组件（支持删除功能）
- ✅ `src/app/experience/page.tsx` - 集成了详情页面的经验页面

### 核心功能
1. ✅ **状态管理**：使用React useState管理表单数据、编辑状态、卡片数据
2. ✅ **数据接口**：定义了ExperienceDetailData接口规范数据结构
3. ✅ **事件处理**：实现了点击编辑、保存、关闭、删除等交互逻辑
4. ✅ **样式设计**：响应式设计，支持桌面和移动端
5. ✅ **进度计算**：实时计算完整度百分比并更新UI
6. ✅ **数据持久化**：使用Map结构管理卡片数据

### 数据结构
```typescript
interface ExperienceDetailData {
  experienceName: string;
  locationAndTime: string;
  scenarioIntroduction: string;
  myRole: string;
  eventProcess: string;
  reflection: string;
  oneLineHighlight: string;
}
```

## 使用方法 ✅

### 1. 从首页开始
1. ✅ 访问 http://localhost:3003
2. ✅ 输入职业目标
3. ✅ 选择一个推荐的行业方向
4. ✅ 点击"Next"按钮进入经验页面

### 2. 在经验页面
1. ✅ 点击任意经验卡片或"Create New Card"按钮
2. ✅ 详情页面会以模态框形式弹出
3. ✅ 点击任意字段区域开始编辑
4. ✅ 观察实时进度条变化
5. ✅ 编辑完成后点击"Confirm"保存
6. ✅ 查看新创建的卡片（含胶囊进度条）
7. ✅ 点击右上角删除按钮删除卡片

### 3. 进度条功能测试
- ✅ **胶囊进度条**：卡片左上角显示完整度
- ✅ **颜色变化**：根据完整度显示红/黄/绿色
- ✅ **实时更新**：编辑内容时进度条实时变化
- ✅ **详情页进度条**：详情页面顶部显示进度

### 4. 示例数据
详情页面预填充了示例数据，展示了完整的经验描述格式：
- ✅ 经验名称：Product Research & Competitor Analysis Lead
- ✅ 地点时间：Beijing | July 2024 - September 2024
- ✅ 情境设定：描述项目背景和环境
- ✅ 我的角色：具体职责和角色定位
- ✅ 事件过程：使用项目符号列出关键成果
- ✅ 反思总结：学习收获和能力提升
- ✅ 一句话高亮：最具影响力的成果总结

## 已完成的开发任务 ✅

1. ✅ **数据持久化**：使用Map结构管理卡片数据，支持实时增删改
2. ✅ **卡片生成**：根据保存的数据在经验页面生成实际的经验卡片
3. ✅ **编辑现有卡片**：支持编辑已创建的经验卡片（通过点击卡片）
4. ✅ **进度跟踪**：实时计算和显示完整度进度条
5. ✅ **删除管理**：支持删除用户创建的卡片
6. ✅ **胶囊进度条**：实现左上角胶囊形进度条设计
7. ✅ **英文字段标签**：所有字段使用英文标签

## 第二阶段需求：AI卡片生成与智能分类系统 🚀

### 📋 **新增功能需求**

#### 1. 智能卡片分类逻辑 🎯
- **自动生成三类方向**：根据用户输入的目标自动生成个性化分类
  - Focus Match（重点匹配）
  - Growth Potential（成长潜力）
  - Foundation Skills（基础技能）
- **卡片归类**：将符合种类的卡片自动归进对应分类
- **默认卡片数量**：每个分类默认显示5张卡片
- **卡片类型划分**：
  - 从用户素材提取的真实经历卡片（深色显示）
  - 系统AI生成的推测性卡片（浅色显示，提醒用户补充）

#### 2. 文件处理与卡片生成 📄
- **自动解析**：用户上传文件后自动解析成卡片
- **无文件处理**：用户未提供文件时该阶段显示空状态
- **新文件上传**：支持在experience页面继续上传新文件
- **实时解析**：新上传文件立即解析成新卡片

#### 3. 悬浮上传功能 📤
- **位置**：左侧界面左下方悬浮按钮
- **交互**：hover显示上传选项
- **功能**：支持上传新文件并解析成卡片

#### 4. 卡片信息提示 ℹ️
- **触发方式**：点击卡片右上角info图标
- **显示内容**：
  - 该分类的分类理由
  - 相关经历描述
  - 为什么推荐这个方向

#### 5. 导航逻辑优化 🧭
- **Back按钮**：左下角，返回目标设定页面
- **Next按钮**：右下角，需完成至少一张卡片后才激活高亮
- **状态管理**：实时检测用户操作状态

#### 6. 引导界面设计 💡
- **位置**：右侧界面
- **内容**：
  - "💡 Not sure where to start?"
  - "Start from your background, ideas or resume — we'll guide you to build your story."
- **快速交互按钮**：提供便捷操作入口

#### 7. 视觉区分系统 🎨
- **真实经历卡片**：深色显示，来源于用户上传内容
- **AI建议卡片**：浅色显示，系统推测补充
- **保持一致性**：不同类型卡片保持清晰视觉区分

### 🤖 **AI提示词规范**

```
请根据以下用户上传的文件内容，将经历进行提取和分类，并且严格按照以下的结构进行经历重新整理

{用户输入内容}

输出格式：
{
  "经验卡片推荐": [
    {
      "卡片分组": "Focus Match",  // 或 "Growth Potential" 或 "Foundation Skills"
      "小卡展示": {
        "经历名称": "项目或实践标题",
        "时间与地点": "Beijing | Jul 2023 – Sept 2023",
        "一句话概述": "用一句话概括你在此经历中的核心贡献或任务"
      },
      "详情卡展示": {
        "经历名称": "完整经历标题",
        "时间与地点": "Beijing | Jul 2023 – Sept 2023",
        "背景与情境说明": "这段经历发生的背景、项目目标或任务前情",
        "我的角色与任务": "你在其中承担的角色，以及所完成的关键任务",
        "任务细节描述": "具体做了什么、采用了什么方法或工具",
        "反思与结果总结": "输出结果、个人成长、对后续工作的影响",
        "高光总结句": "This experience helped me strengthen my stakeholder communication skills.",
        "可编辑字段": [
          "背景与情境说明",
          "我的角色与任务",
          "任务细节描述",
          "反思与结果总结",
          "高光总结句"
        ],
        "生成来源": {
          "类型": "上传简历" // 或 "用户输入" 或 "AI生成"
        }
      }
    }
  ]
}
```

### 📊 **实现状态**

#### ✅ **已完成功能**
1. 基础卡片展示和编辑功能
2. 卡片删除管理
3. 用户手动创建卡片
4. 进度跟踪系统
5. 基础文件上传组件

#### ✅ **第二阶段已完成功能**
1. ✅ **AI卡片生成与分类算法** - 完成Gemini AI集成和智能卡片生成
2. ✅ **文件内容解析与卡片转换** - 实现文件上传和内容解析
3. ✅ **智能分类逻辑实现** - 按Focus Match、Growth Potential、Foundation Skills分类
4. ✅ **AI卡片编辑功能** - 支持点击AI生成的卡片进行编辑
5. ✅ **数据格式转换** - AI响应格式与现有卡片数据结构的完美映射
6. ✅ **加载状态显示** - 生成AI卡片时的用户友好加载界面
7. ✅ **文件处理增强** - experience页面支持新文件上传和处理

#### 🔄 **待实现功能**
1. 卡片信息提示弹窗（info图标功能）
2. 引导界面设计（右侧引导面板）
3. 视觉区分系统优化（深浅色卡片区分）
4. 导航状态管理优化（Next按钮激活逻辑）

## 下一步开发建议

### 🎯 **第二阶段开发重点**
1. **AI集成**：实现文件内容解析和智能卡片生成
2. **分类算法**：根据用户目标智能分类卡片
3. **UI优化**：实现深浅色卡片视觉区分
4. **交互完善**：添加info提示和引导界面
5. **状态管理**：优化导航按钮激活逻辑

### �️ **第二阶段技术实现详情**

#### **新增API端点**
- ✅ `src/app/api/ai/generate-experience-cards/route.ts` - AI卡片生成API
  - 支持文件上传和内容解析
  - 集成Gemini AI进行智能分析
  - 返回结构化的经验卡片数据
  - 包含完整的错误处理和fallback机制

#### **AI提示词系统**
- ✅ `EXPERIENCE_EXTRACTION_PROMPT` - 文件内容提取和分类
- ✅ `EXPERIENCE_CARD_GENERATION_PROMPT` - 基于目标生成AI建议卡片
- ✅ 支持中英文混合处理
- ✅ 严格的JSON格式输出控制

#### **前端功能增强**
- ✅ **智能卡片生成**：页面加载时自动调用AI生成相关卡片
- ✅ **文件处理增强**：experience页面支持新文件上传和实时处理
- ✅ **卡片编辑功能**：支持编辑AI生成的卡片内容
- ✅ **数据格式转换**：AI响应与ExperienceCard类型的完美映射
- ✅ **加载状态管理**：用户友好的加载指示器和状态反馈

#### **数据流程**
```
用户目标 + 选择行业 + 上传文件
    ↓
Gemini AI分析和分类
    ↓
结构化JSON响应
    ↓
转换为ExperienceCard格式
    ↓
按分类渲染到对应Direction
    ↓
支持点击编辑和删除操作
```

#### **核心函数**
- ✅ `generateAICards()` - 主要的AI卡片生成逻辑
- ✅ `convertAICardToExperienceCard()` - 数据格式转换
- ✅ `handleFileUpload()` - 增强的文件处理
- ✅ `handleCardClick()` - 支持AI卡片编辑
- ✅ `handleDetailModalSave()` - 支持更新现有卡片

### 📋 **剩余技术实现计划**
1. **信息提示组件**：卡片右上角info图标和弹窗
2. **引导界面组件**：右侧引导面板设计
3. **视觉区分系统**：深浅色卡片样式区分
4. **导航逻辑优化**：Next按钮激活状态管理

## 测试完成情况 ✅

已测试以下场景：
1. ✅ 创建新的经验卡片
2. ✅ 编辑各个字段的内容
3. ✅ 测试长文本内容的显示
4. ✅ 验证保存和取消功能
5. ✅ 测试响应式设计在不同屏幕尺寸下的表现
6. ✅ 测试进度条颜色变化
7. ✅ 测试删除功能
8. ✅ 测试胶囊进度条显示
